<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YKTUBE</title>
<style>
  body { margin:0; font-family: Arial, Helvetica, sans-serif; background-color: #141414; color: #fff; }
  header { background-color: #e50914; padding: 10px 20px; font-size: 24px; font-weight: bold; }
  .login-container, .app-container { max-width: 900px; margin: 30px auto; text-align: center; }
  input, button { padding: 10px; margin: 5px; font-size: 16px; }
  .video-card { background-color: #222; margin: 10px; padding: 10px; border-radius: 5px; display: inline-block; vertical-align: top; width: 300px; }
  .video-card video { width: 100%; border-radius: 5px; }
  .video-list { display: flex; flex-wrap: wrap; justify-content: center; }
  .video-card button { margin-top: 5px; }
  #searchInput { width: 300px; padding: 10px; margin-bottom: 20px; font-size: 16px; }
</style>
</head>
<body>

<header>YKTUBE</header>

<div class="login-container" id="loginDiv">
  <h2>Giriş Yap veya Kayıt Ol</h2>
  <input type="text" id="username" placeholder="İsim"><br>
  <input type="password" id="password" placeholder="Şifre"><br>
  <button onclick="login()">Giriş Yap</button>
  <button onclick="register()">Kayıt Ol</button>
  <p id="loginError" style="color:red;"></p>
</div>

<div class="app-container" id="appDiv" style="display:none;">
  <h2>Hoşgeldin <span id="userNameSpan"></span></h2>

  <div id="adminPanel" style="display:none;">
    <h3>Film Ekle</h3>
    <input type="text" id="videoTitle" placeholder="Film İsmi">
    <input type="text" id="videoUrl" placeholder="Video URL">
    <button onclick="addVideo()">Ekle</button>
  </div>

  <input type="text" id="searchInput" placeholder="Video Ara..." onkeyup="searchVideos()">

  <h3>Filmler</h3>
  <div class="video-list" id="videoList">
    <!-- Videolar buraya eklenecek -->
  </div>
</div>

<script>
// Admin bilgileri
const adminUser = "Yasin Emir Kahya";
const adminPass = "yktubefilimuygulaması9462";

// GitHub Raw JSON URL'leri
const usersURL = "https://raw.githubusercontent.com/kullaniciAdi/depoAdi/main/users.json";
const videosURL = "https://raw.githubusercontent.com/kullaniciAdi/depoAdi/main/videos.json";

let users = [];
let videos = [];

// GitHub’dan JSON verilerini çek
function fetchData(){
  fetch(usersURL)
    .then(res => res.json())
    .then(data => { users = data; })
    .catch(err => console.error("Kullanıcı JSON çekilemedi:", err));

  fetch(videosURL)
    .then(res => res.json())
    .then(data => { videos = data; loadVideos(); })
    .catch(err => console.error("Video JSON çekilemedi:", err));
}

// Kayıt fonksiyonu (simülasyon)
function register() {
  const username = document.getElementById("username").value;
  const password = document.getElementById("password").value;

  if(!username || !password){
    document.getElementById("loginError").innerText = "Lütfen kullanıcı adı ve şifre girin.";
    return;
  }

  if(users.find(u => u.username === username)){
    document.getElementById("loginError").innerText = "Bu kullanıcı zaten kayıtlı.";
    return;
  }

  users.push({username,password});
  document.getElementById("loginError").style.color = "green";
  document.getElementById("loginError").innerText = "Kayıt başarılı! Giriş yapabilirsiniz.";
  // Not: Gerçek GitHub güncellemesi için GitHub API gerekir
}

// Giriş fonksiyonu
function login() {
  const username = document.getElementById("username").value;
  const password = document.getElementById("password").value;

  if(username === adminUser && password === adminPass){
    localStorage.setItem("currentUser", username);
    localStorage.setItem("isAdmin", true);
    openApp();
    return;
  }

  const user = users.find(u => u.username === username && u.password === password);
  if(user){
    localStorage.setItem("currentUser", username);
    localStorage.setItem("isAdmin", false);
    openApp();
  } else {
    document.getElementById("loginError").style.color = "red";
    document.getElementById("loginError").innerText = "Kullanıcı adı veya şifre hatalı.";
  }
}

// Uygulamayı aç
function openApp(){
  document.getElementById("loginDiv").style.display = "none";
  document.getElementById("appDiv").style.display = "block";
  const currentUser = localStorage.getItem("currentUser");
  document.getElementById("userNameSpan").innerText = currentUser;

  if(localStorage.getItem("isAdmin") === "true"){
    document.getElementById("adminPanel").style.display = "block";
  }

  fetchData();
}

// Videoları listeleme
function loadVideos() {
  const videoListDiv = document.getElementById("videoList");
  videoListDiv.innerHTML = "";
  videos.forEach((video, index) => {
    const div = document.createElement("div");
    div.className = "video-card";
    div.setAttribute("data-title", video.title.toLowerCase());
    div.innerHTML = `<strong>${video.title}</strong><br>
                     <video controls>
                       <source src="${video.url}" type="video/mp4">
                     </video><br>
                     <small>Ekleyen: ${video.user}</small>`;
    if(localStorage.getItem("isAdmin") === "true"){
      const btn = document.createElement("button");
      btn.innerText = "Sil";
      btn.onclick = () => deleteVideo(index);
      div.appendChild(btn);
    }
    videoListDiv.appendChild(div);
  });
}

// Video ekleme (admin)
function addVideo() {
  const title = document.getElementById("videoTitle").value;
  const url = document.getElementById("videoUrl").value;
  const user = localStorage.getItem("currentUser");

  if(title && url){
    videos.push({title,url,user});
    document.getElementById("videoTitle").value = "";
    document.getElementById("videoUrl").value = "";
    loadVideos();
    // Not: Gerçek GitHub güncellemesi için API gerekir
  }
}

// Video silme (admin)
function deleteVideo(index){
  videos.splice(index,1);
  loadVideos();
  // Not: Gerçek GitHub güncellemesi için API gerekir
}

// Video arama
function searchVideos(){
  const input = document.getElementById("searchInput").value.toLowerCase();
  const videoCards = document.querySelectorAll(".video-card");
  videoCards.forEach(card => {
    const title = card.getAttribute("data-title");
    card.style.display = title.includes(input) ? "inline-block" : "none";
  });
}

</script>
</body>
</html>